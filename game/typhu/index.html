<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C·ªù T·ª∑ Ph√∫ - Phi√™n B·∫£n Tr√¨nh Chi·∫øu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* T√πy ch·ªânh font ch·ªØ cho to√†n b·ªô trang */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Thi·∫øt l·∫≠p layout cho b√†n c·ªù */
        #game-board {
            display: grid;
            grid-template-columns: repeat(11, minmax(0, 1fr));
            grid-template-rows: repeat(11, minmax(0, 1fr));
            /* Gi·ªØ t·ª∑ l·ªá vu√¥ng cho b√†n c·ªù */
            width: clamp(320px, 80vh, 700px); /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc ƒë·ªÉ ph√π h·ª£p v·ªõi layout ngang */
            aspect-ratio: 1 / 1;
        }

        /* ƒê·ªãnh d·∫°ng chung cho c√°c √¥ tr√™n b√†n c·ªù */
        .square {
            border: 1px solid #4b5563; /* gray-600 */
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            text-align: center;
            padding: 2px;
            font-weight: bold;
        }

        /* ƒê·ªãnh d·∫°ng cho qu√¢n c·ªù c·ªßa ng∆∞·ªùi ch∆°i */
        .player-token {
            position: absolute;
            width: 25%;
            height: 25%;
            border-radius: 9999px;
            transition: all 0.3s ease-in-out;
            font-size: clamp(10px, 2vw, 18px);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* V·ªã tr√≠ c√°c qu√¢n c·ªù trong c√πng m·ªôt √¥ ƒë·ªÉ kh√¥ng b·ªã ƒë√® l√™n nhau */
        .player-token[data-player-index="0"] { top: 10%; left: 10%; }
        .player-token[data-player-index="1"] { top: 10%; right: 10%; }
        .player-token[data-player-index="2"] { bottom: 10%; left: 10%; }
        .player-token[data-player-index="3"] { bottom: 10%; right: 10%; }
        .player-token[data-player-index="4"] { top: 40%; left: 10%; }
        .player-token[data-player-index="5"] { top: 40%; right: 10%; }
        .player-token[data-player-index="6"] { bottom: 40%; left: 10%; }
        .player-token[data-player-index="7"] { bottom: 40%; right: 10%; }

        /* Hi·ªáu ·ª©ng khi ch·ªçn ng∆∞·ªùi ch∆°i */
        .player-info-card.selected {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.7); /* blue-500 */
        }
    </style>
    <!-- Th√™m font Inter t·ª´ Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 flex flex-col md:flex-row items-center justify-center min-h-screen p-4 gap-8">

    <!-- B√†n c·ªù -->
    <div id="game-board-container" class="flex items-center justify-center">
        <div id="game-board" class="bg-gray-200 shadow-xl rounded-lg border-4 border-gray-700">
            <!-- C√°c √¥ c·ªù s·∫Ω ƒë∆∞·ª£c t·∫°o b·ªüi JavaScript -->
        </div>
    </div>

    <!-- B·∫£ng ƒëi·ªÅu khi·ªÉn b√™n c·∫°nh -->
    <div id="side-panel" class="w-full max-w-sm bg-white p-6 rounded-lg shadow-xl space-y-4">
        <h1 class="text-3xl font-bold mb-4 text-center text-gray-800">C·ªù T·ª∑ Ph√∫ Vui V·∫ª</h1>

        <!-- Danh s√°ch ng∆∞·ªùi ch∆°i v√† ƒëi·ªÉm s·ªë -->
        <div id="player-scores" class="grid grid-cols-2 gap-3">
            <!-- Th√¥ng tin ng∆∞·ªùi ch∆°i s·∫Ω ƒë∆∞·ª£c t·∫°o b·ªüi JavaScript -->
        </div>

        <!-- Khu v·ª±c ƒëi·ªÅu khi·ªÉn -->
        <div id="controls" class="space-y-3 pt-4 border-t">
             <p class="text-lg text-center">
                L∆∞·ª£t c·ªßa: <span id="selected-player-name" class="font-bold text-blue-600">H√£y ch·ªçn ng∆∞·ªùi ch∆°i</span>
            </p>
            <input type="number" id="move-input" min="1" placeholder="Nh·∫≠p s·ªë b∆∞·ªõc..." class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500">
            <button id="move-button" class="w-full bg-blue-500 text-white p-3 rounded-md hover:bg-blue-600 font-bold transition-colors disabled:bg-gray-400" disabled>Di Chuy·ªÉn</button>
        </div>
    </div>

    <!-- Modal cho th√¥ng b√°o -->
    <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50">
        <div id="modal-content" class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md text-center transform transition-all scale-95 opacity-0">
            <h2 id="modal-title" class="text-2xl font-bold mb-4">Th√¥ng b√°o</h2>
            <div id="modal-body">
                <p id="modal-message" class="text-lg mb-4"></p>
                <!-- C√°c n√∫t h√†nh ƒë·ªông cho gi√°o vi√™n -->
                <div id="task-buttons" class="hidden mt-6 flex justify-center gap-4">
                    <!-- C√°c n√∫t Ho√†n th√†nh / Ch∆∞a ho√†n th√†nh s·∫Ω ƒë∆∞·ª£c t·∫°o b·ªüi JS -->
                </div>
            </div>
            <button id="close-modal-button" class="hidden mt-6 bg-gray-500 text-white py-2 px-6 rounded-md hover:bg-gray-600">ƒê√≥ng</button>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- C·∫§U H√åNH GAME ---
        const NUM_PLAYERS = 8;
        const BOARD_SIZE = 40;

        const playerIcons = ['üöÄ', 'ü¶Ñ', '‚öΩÔ∏è', 'üèÄ', 'üé±', 'üéØ', 'üé≤', 'üëæ'];
        const playerColors = ['#ef4444', '#f97316', '#eab308', '#84cc16', '#22c55e', '#14b8a6', '#0ea5e9', '#8b5cf6'];
        
        // --- TR·∫†NG TH√ÅI GAME ---
        let players = [];
        let board = [];
        let selectedPlayerId = null;
        let currentPlayerAction = { player: null, squareType: null };

        // --- DOM ELEMENTS ---
        const gameBoard = document.getElementById('game-board');
        const playerScoresContainer = document.getElementById('player-scores');
        const selectedPlayerName = document.getElementById('selected-player-name');
        const moveInput = document.getElementById('move-input');
        const moveButton = document.getElementById('move-button');
        const modal = document.getElementById('modal');
        const modalContent = document.getElementById('modal-content');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const taskButtonsContainer = document.getElementById('task-buttons');
        const closeModalButton = document.getElementById('close-modal-button');

        // --- H√ÄM KH·ªûI T·∫†O ---

        function initGame() {
            createPlayers();
            createBoard();
            renderBoard();
            renderPlayerInfo();
            renderPlayerTokens();
            setupEventListeners();
        }

        function createPlayers() {
            for (let i = 0; i < NUM_PLAYERS; i++) {
                players.push({
                    id: i,
                    name: `Ng∆∞·ªùi ch∆°i ${i + 1}`,
                    icon: playerIcons[i],
                    color: playerColors[i],
                    position: 0,
                    score: 0
                });
            }
        }

        function createBoard() {
            const types = ['start', 'normal', 'bonus', 'normal', 'penalty', 'normal', 'chance', 'normal', 'bonus', 'normal', 'penalty',
                           'normal', 'chance', 'normal', 'penalty', 'normal', 'bonus', 'normal', 'chance', 'normal', 'penalty',
                           'normal', 'bonus', 'normal', 'penalty', 'normal', 'chance', 'normal', 'bonus', 'normal', 'penalty',
                           'normal', 'penalty', 'normal', 'chance', 'normal', 'bonus', 'normal', 'penalty', 'normal'];
            for (let i = 0; i < BOARD_SIZE; i++) {
                board.push({ id: i, type: types[i] });
            }
        }

        function setupEventListeners() {
            playerScoresContainer.addEventListener('click', handlePlayerSelect);
            moveButton.addEventListener('click', handleMove);
            closeModalButton.addEventListener('click', hideModal);
        }

        // --- H√ÄM RENDER ---

        function renderBoard() {
            const squarePositions = [];
            // Bottom row (0-10)
            for (let i = 0; i <= 10; i++) squarePositions.push({ row: 11, col: 11 - i });
            // Left row (11-20)
            for (let i = 1; i <= 9; i++) squarePositions.push({ row: 11 - i, col: 1 });
            // Top row (21-30)
            for (let i = 0; i <= 10; i++) squarePositions.push({ row: 1, col: 1 + i });
            // Right row (31-39)
            for (let i = 1; i <= 9; i++) squarePositions.push({ row: 1 + i, col: 11 });

            board.forEach((squareData, i) => {
                const squareEl = document.createElement('div');
                squareEl.className = 'square';
                squareEl.dataset.squareId = i;
                
                const pos = squarePositions[i];
                squareEl.style.gridRow = pos.row;
                squareEl.style.gridColumn = pos.col;

                let bgColor, text, textColor;
                switch (squareData.type) {
                    case 'start': bgColor = 'bg-green-600'; text = 'B·∫Øt ƒê·∫ßu'; textColor = 'text-white'; break;
                    case 'bonus': bgColor = 'bg-yellow-400'; text = 'Th∆∞·ªüng'; textColor = 'text-gray-800'; break;
                    case 'penalty': bgColor = 'bg-red-600'; text = 'Ph·∫°t'; textColor = 'text-white'; break;
                    case 'chance': bgColor = 'bg-blue-500'; text = 'C∆° H·ªôi'; textColor = 'text-white'; break;
                    case 'corner': bgColor = 'bg-gray-400'; text = 'G√≥c'; textColor = 'text-gray-800'; break;
                    default: bgColor = 'bg-green-200'; text = `√î ${i}`; textColor = 'text-gray-700';
                }

                squareEl.innerHTML = `<span>${text}</span>`;
                squareEl.classList.add(bgColor, textColor);
                gameBoard.appendChild(squareEl);
            });
        }
        
        function renderPlayerInfo() {
            playerScoresContainer.innerHTML = '';
            players.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.dataset.playerId = player.id;
                playerCard.className = `player-info-card p-3 rounded-lg border-2 transition-all cursor-pointer`;
                playerCard.style.borderColor = player.color;
                
                if (player.id === selectedPlayerId) {
                    playerCard.classList.add('selected', 'bg-blue-100');
                } else {
                    playerCard.classList.add('bg-gray-50');
                }

                playerCard.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <span class="text-3xl">${player.icon}</span>
                        <div>
                            <div class="font-bold">${player.name}</div>
                            <div class="text-gray-600">ƒêi·ªÉm: <span class="font-bold">${player.score}</span></div>
                        </div>
                    </div>
                `;
                playerScoresContainer.appendChild(playerCard);
            });
        }
        
        function renderPlayerTokens() {
            // X√≥a token c≈©
            document.querySelectorAll('.player-token').forEach(token => token.remove());

            // V·∫Ω token m·ªõi
            players.forEach(player => {
                const token = document.createElement('div');
                token.className = 'player-token';
                token.dataset.playerIndex = player.id;
                token.innerHTML = player.icon;
                token.style.backgroundColor = player.color;

                const targetSquare = gameBoard.querySelector(`[data-square-id='${player.position}']`);
                if (targetSquare) {
                    targetSquare.appendChild(token);
                }
            });
        }

        // --- H√ÄM X·ª¨ L√ù S·ª∞ KI·ªÜN ---

        function handlePlayerSelect(e) {
            const card = e.target.closest('.player-info-card');
            if (card) {
                selectedPlayerId = parseInt(card.dataset.playerId);
                const player = players[selectedPlayerId];
                selectedPlayerName.textContent = `${player.icon} ${player.name}`;
                moveButton.disabled = false;
                renderPlayerInfo();
            }
        }

        function handleMove() {
            const moves = parseInt(moveInput.value);
            if (isNaN(moves) || moves <= 0 || selectedPlayerId === null) {
                // Thay th·∫ø alert() b·∫±ng modal
                showModalMessage("L·ªói", "Vui l√≤ng ch·ªçn ng∆∞·ªùi ch∆°i v√† nh·∫≠p s·ªë b∆∞·ªõc h·ª£p l·ªá.");
                return;
            }

            const player = players[selectedPlayerId];
            player.position = (player.position + moves) % BOARD_SIZE;
            
            moveInput.value = '';
            renderPlayerTokens();

            // X·ª≠ l√Ω s·ª± ki·ªán t·∫°i √¥ m·ªõi
            setTimeout(() => {
                const landedSquare = board[player.position];
                handleSquareAction(player, landedSquare.type);
            }, 500); // ƒê·ª£i 0.5s cho hi·ªáu ·ª©ng di chuy·ªÉn
        }
        
        function handleSquareAction(player, squareType) {
            currentPlayerAction = { player, squareType };

            switch (squareType) {
                case 'bonus':
                    player.score += 10;
                    showModalMessage(`√î Th∆∞·ªüng!`, `${player.name} ƒë∆∞·ª£c c·ªông 10 ƒëi·ªÉm.`);
                    renderPlayerInfo();
                    break;
                case 'normal':
                case 'penalty':
                case 'chance':
                    showTaskModal(player, squareType);
                    break;
                default:
                    // Kh√¥ng l√†m g√¨ v·ªõi √¥ 'start' ho·∫∑c 'corner'
                    break;
            }
        }

        function handleTaskResult(isCorrect) {
            const { player, squareType } = currentPlayerAction;
            let points = 0;
            let message = '';

            if (isCorrect) {
                switch (squareType) {
                    case 'normal': points = 10; break;
                    case 'penalty': points = 5; break;
                    case 'chance': points = 20; break;
                }
                message = `Ch√≠nh x√°c! ${player.name} ƒë∆∞·ª£c c·ªông ${points} ƒëi·ªÉm.`;
            } else { // Incorrect
                switch (squareType) {
                    case 'penalty': points = -10; break;
                    default: points = 0; break;
                }
                message = `R·∫•t ti·∫øc! ${points === 0 ? `${player.name} kh√¥ng ƒë∆∞·ª£c ƒëi·ªÉm.` : `${player.name} b·ªã tr·ª´ ${Math.abs(points)} ƒëi·ªÉm.`}`;
            }

            player.score += points;
            
            taskButtonsContainer.classList.add('hidden');
            hideModal();
            
            setTimeout(() => {
                renderPlayerInfo();
                showModalMessage("K·∫øt qu·∫£", message);
            }, 300);
        }

        // --- H√ÄM ƒêI·ªÄU KHI·ªÇN MODAL ---

        function showModal() {
            modal.classList.remove('hidden');
            setTimeout(() => {
                modalContent.classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        function hideModal() {
             modalContent.classList.add('scale-95', 'opacity-0');
             setTimeout(() => {
                modal.classList.add('hidden');
             }, 200);
        }
        
        function showModalMessage(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modalMessage.classList.remove('hidden');
            taskButtonsContainer.classList.add('hidden');
            closeModalButton.classList.remove('hidden');
            showModal();
        }

        function showTaskModal(player, squareType) {
            let title = '';
            let description = '';

            switch (squareType) {
                case 'normal':
                    title = '√î Th∆∞·ªùng';
                    description = 'Gi√°o vi√™n s·∫Ω ƒë·ªçc c√¢u h·ªèi. Tr·∫£ l·ªùi ƒë√∫ng ƒë∆∞·ª£c 10 ƒëi·ªÉm.';
                    break;
                case 'penalty':
                    title = '√î Ph·∫°t';
                    description = 'Gi√°o vi√™n s·∫Ω ƒë·ªçc c√¢u h·ªèi. Tr·∫£ l·ªùi ƒë√∫ng ƒë∆∞·ª£c 5 ƒëi·ªÉm, tr·∫£ l·ªùi sai b·ªã tr·ª´ 10 ƒëi·ªÉm.';
                    break;
                case 'chance':
                    title = '√î C∆° H·ªôi';
                    description = 'Gi√°o vi√™n s·∫Ω ƒë·ªçc c√¢u h·ªèi. Tr·∫£ l·ªùi ƒë√∫ng ƒë∆∞·ª£c 20 ƒëi·ªÉm.';
                    break;
            }
            
            modalTitle.textContent = title;
            modalMessage.textContent = description;
            modalMessage.classList.remove('hidden');

            taskButtonsContainer.innerHTML = `
                <button id="complete-button" class="bg-green-500 text-white py-2 px-6 rounded-md hover:bg-green-600 font-semibold">Ho√†n th√†nh</button>
                <button id="fail-button" class="bg-red-500 text-white py-2 px-6 rounded-md hover:bg-red-600 font-semibold">Ch∆∞a ho√†n th√†nh</button>
            `;
            taskButtonsContainer.classList.remove('hidden');
            
            document.getElementById('complete-button').onclick = () => handleTaskResult(true);
            document.getElementById('fail-button').onclick = () => handleTaskResult(false);
            
            closeModalButton.classList.add('hidden');
            showModal();
        }

        // --- B·∫ÆT ƒê·∫¶U GAME ---
        initGame();
    });
    </script>
</body>
</html>


